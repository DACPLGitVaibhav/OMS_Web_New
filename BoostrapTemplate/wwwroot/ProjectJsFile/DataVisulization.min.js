function CheckLineStatus(){$.ajax({type:"GET",url:"/DataVisulization/GetLineStatus",dataType:"json",success:function(n){n==!0?$(".alert-danger").show():$(".alert-danger").hide()}})}function startReload(){IsstopInt=!1;reloadTable(rowsPerPage);reloadInterval=setInterval(function(){reloadTable(rowsPerPage)},5e3)}function stopReload(){IsstopInt=!0;clearInterval(reloadInterval)}function reloadTable(){$.ajax({url:"/DataVisulization/ReLoadData",type:"GET",dataType:"json",success:function(n){totalData=n;renderTable()},error:function(){}})}function renderTable(){if(IsstopInt==!1){const u=$("#Table tbody");u.empty();var n=currentPage*rowsPerPage,i=n+rowsPerPage,r=totalData.slice(n,i),t=0;r.forEach(function(n){var i=n.erpSeqNo,r=n.itemId,f=n.biwNo,e=n.vcode,a=n.lineID,v=n.status,o=n.ff,s=n.fe,h=n.rf,c=n.bslh,l=n.bsrh;u.append("<tr class='data-row'><td><input type='checkbox' class='checkbox'><\/td><td>"+i+"<\/td><td>"+r+"<\/td><td>"+f+"<\/td><td>"+e+"<\/td><td> <button class='Chenge' data-id='"+o+"' style='color: white; border:none'>0<\/button> <\/td><td><button class='Chenge' data-id='"+s+"' style='color: white; border:none'>0<\/button> <\/td><td><button class='Chenge' data-id='"+h+"' style='color: white; border:none'>0<\/button> <\/td><td> <button class='Chenge' data-id='"+l+"' style='color: white; border:none'>0<\/button><\/td><td> <button class='Chenge' data-id='"+c+"' style='color: white; border:none'>0<\/button><\/td><\/tr>");$(".Chenge").each(function(){$(this).attr("data-id")==0&&$(this).css("background-color","#337ab7");$(this).attr("data-id")==1&&$(this).css("background-color","#999966");$(this).attr("data-id")==2&&$(this).css("background-color","#777777");$(this).attr("data-id")==3&&$(this).css("background-color","#f0ad4e");$(this).attr("data-id")==4&&$(this).css("background-color","#5cb85c");$(this).attr("data-id")==100&&$(this).css("background-color","#5bc0de");$(this).attr("data-id")==101&&$(this).css("background-color","#d9534f");$(this).attr("data-id")==102&&$(this).css("background-color","#000000")});t=totalData.reduce(function(n,t){return t.ff===0&&t.fe===0&&t.rf===0&&t.bslh===0&&t.bsrh===0?n+1:n},0)});$("#countDisplay").text(`Pending Orders: ${t}`);generatePageButtons()}}function generatePageButtons(){var t,e;$("#TRFBtnContainer").empty();$("#buttonContainer").empty();$("#RowcountDisplay").empty();const n=$("#pageButtons");n.empty();var u=Math.ceil(totalData.length/rowsPerPage),i=10,r=Math.max(0,currentPage-Math.floor(i/2)),f=Math.min(u-1,r+i-1);for(f-r<i-1&&(r=Math.max(0,f-i+1)),currentPage>0&&(n.append('<li><a href="#" class="page-button" data-page="0">First<\/a><\/li>'),n.append('<li><a href="#" class="page-button" data-page="'+(currentPage-1)+'">Prev<\/a><\/li>')),t=r;t<=f;t++)e=t===currentPage?"current-page":"",n.append('<li><a href="#" class="page-button '+e+'" data-page="'+t+'">'+(t+1)+"<\/a><\/li>");currentPage<u-1&&(n.append('<li><a href="#" class="page-button" data-page="'+(currentPage+1)+'">Next<\/a><\/li>'),n.append('<li><a href="#" class="page-button" data-page="'+(u-1)+'">Last<\/a><\/li>'))}function deselectRowsAndRemoveFromErpSeqArray(){var n=$("#Table tbody tr").not(".selected");n.each(function(){var t=$(this).find("td:eq(1)").text(),n=ErpSeqArray.indexOf(t);n!==-1&&ErpSeqArray.splice(n,1)})}var reloadInterval,currentPage=0,rowsPerPage=100,totalData=[],IsstopInt=!1,ErpSeqArray,ErpSeqArray2;$(document).ready(function(){$("#Table").DataTable({dom:"Blfrtip",ordering:!1,paging:!1,info:!1,buttons:[],columnDefs:[{}],columns:[{data:""},{data:"biwNo"},{data:"bslh"},{data:"bsrh"},{data:"erpSeqNo"},{data:"fe"},{data:"ff"},{data:"itemId"},{data:"vcode"},{data:"rf"},],autoWidth:!1,drawCallback:function(){$(".Chenge").each(function(){$(this).attr("data-id")==0&&$(this).css("background-color","#337ab7");$(this).attr("data-id")==1&&$(this).css("background-color","#999966");$(this).attr("data-id")==2&&$(this).css("background-color","#777777");$(this).attr("data-id")==3&&$(this).css("background-color","#f0ad4e");$(this).attr("data-id")==4&&$(this).css("background-color","#5cb85c");$(this).attr("data-id")==100&&$(this).css("background-color","#5bc0de");$(this).attr("data-id")==101&&$(this).css("background-color","#d9534f");$(this).attr("data-id")==102&&$(this).css("background-color","#000000")})}});$("#pageButtons").on("click",".page-button",function(){currentPage=parseInt($(this).data("page"),10);renderTable()});$("#rowsPerPage").on("change",function(){$("#TRFBtnContainer").empty();$("#buttonContainer").empty();$("#RowcountDisplay").empty();rowsPerPage=parseInt($(this).val(),10);rowsPerPage!=100&&(currentPage=0);reloadTable(rowsPerPage)});generatePageButtons();startReload();CheckLineStatus();setInterval(CheckLineStatus,3e3)});ErpSeqArray=[];ErpSeqArray2=[];$(document).ready(function(){var u=$("#Table").DataTable(),n=0,t,i,r;$("#Table tbody").on("click","tr",function(){var l,c,p;if(stopReload(),event.target.type!=="checkbox"&&(l=$(this).find(".checkbox"),l.prop("checked",!l.prop("checked"))),$(this).toggleClass("selected"),n=$("#Table tbody tr.selected").length,$("#RowcountDisplay").text(`Order Selected: ${n}`),t=$("<button/>",{"class":"btn btn-primary",text:"Transfer To PreProduction",click:function(){var n=confirm("Are you sure you want to Transfer to PreProduction these orders?");n?$.ajax({type:"GET",url:"/DataVisulization/GetLineStatus",dataType:"json",success:function(n){var t=n;t==!0?$.ajax({type:"POST",url:"/DataVisulization/TRFToPreProduction",dataType:"json",contentType:"application/json",data:JSON.stringify(ErpSeqArray),success:function(n){n.status==="Executed"&&(alert("Selected orders has been revert back to pre-production."),window.location.href="/DataVisulization/PreProductionOrders");n.status==="error"&&(alert("Order should be on scheduled stage!"),alert("Refresh Page "),location.reload());n.status==="Unauthorized"&&(alert(n.message),location.reload())}}):(alert("You Need To Stop All Lines"),$("#TRFBtnContainer").empty(),$("#buttonContainer").empty(),$("#RowcountDisplay").empty());startReload()}}):(alert("Order Transfer to PreProduction canceled."),startReload())}}),i=$("<button>",{"class":"btnAbound",html:'<i class="fa fa-trash"><\/i>',click:function(){var n=confirm("Are you sure you want to Abound this order?");n?$.ajax({type:"POST",url:"/DataVisulization/SetAbandoned",dataType:"json",contentType:"application/json",data:JSON.stringify(ErpSeqArray),success:function(n){n.status==="Set Abandoned"&&alert("Order Abandoned.");n.status==="error"&&(alert("Refresh Page "),location.reload());n.status==="error1"&&(alert("Order Already Executed You Can Not Abandon Order"),location.reload());n.status==="Unauthorized"&&(alert(n.message),location.reload());startReload()}}):(alert("Order abandonment canceled."),startReload());$("#buttonContainer").empty();$("#TRFBtnContainer").empty();$("#RowcountDisplay").empty()}}),r=$("<button/>",{"class":"swp",html:"SWAP",click:function(){var n=confirm("Are you sure you want to Swap this orders?");n?$.ajax({type:"POST",url:"/DataVisulization/SwapOrder",dataType:"json",contentType:"application/json",data:JSON.stringify(ErpSeqArray),success:function(n){n.status==="Executed"&&alert("Order Swap Successfully.");n.status==="error"&&(alert("Refresh Page "),location.reload());n.status==="error1"&&(alert("Order Already Executed You Can Not Swap Order"),location.reload());n.status==="Unauthorized"&&(alert(n.message),location.reload());startReload()}}):(alert("Order Swap canceled."),startReload());$("#buttonContainer").empty();$("#TRFBtnContainer").empty();$("#RowcountDisplay").empty()}}),n===1){deselectRowsAndRemoveFromErpSeqArray();var u=$("#Table tbody tr.selected"),a=u.find("td:eq(1)").text(),w=u.find("td:eq(2)").text(),b=u.find("td:eq(3)").text(),f=u.find("td:eq(5) button").attr("data-id"),e=u.find("td:eq(6) button").attr("data-id"),o=u.find("td:eq(7) button").attr("data-id"),s=u.find("td:eq(8) button").attr("data-id"),h=u.find("td:eq(9) button").attr("data-id");ErpSeqArray.includes(a)||ErpSeqArray.push(a);(f==="0"||f==="100"||f==="101")&&(e==="0"||e==="100"||e==="101")&&(o==="0"||o==="100"||o==="101")&&(h==="0"||h==="100"||h==="101")&&(s==="0"||s==="100"||s==="101")?(c=$("<button>",{text:"✙ BREAKPOINT","class":"brkbutton",click:function(){var n="";n=$(c).html()=="✙ BREAKPOINT"?confirm("Are you sure, you want to Perform Breakpoint Operation?"):confirm("Are you sure, you want to release Breakpoint Operation?");n?($.ajax({type:"POST",dataType:"json",data:{ErpSeqNo:a,ItemId:w,BiwNo:b,FF:f,FE:e,RF:o,BSLH:h,BSRH:s},url:"/DataVisulization/SetBreakPoint",success:function(n){n.status==="SetBreakpoint"&&alert("Set Breakpoint");n.status==="ReleseBreakPoint"&&alert("Relese Breakpoint");n.status==="error"&&(alert("Refresh Page "),location.reload());n.status==="error1"&&(alert("Order Already Executed You Can Not Set BREAKPOINT"),location.reload());n.status==="Unauthorized"&&(alert(n.message),location.reload());startReload()}}),$("#buttonContainer").empty(),$("#TRFBtnContainer").empty(),$("#RowcountDisplay").empty()):(alert("Breakpoint Operation canceled."),startReload())}}),f==="100"&&e==="100"&&o==="100"&&h==="100"&&s==="100"?$(c).text("− RELEASE BREAKPOINT"):$(c).text("✙ BREAKPOINT"),f==="100"&&e==="100"&&o==="100"&&s==="100"&&h==="100"?$("#buttonContainer").empty().append(c):f==="101"&&e==="101"&&o==="101"&&s==="101"&&h==="101"?($("#buttonContainer").empty().append(i),$("#TRFBtnContainer").empty().append(t)):($("#buttonContainer").empty().append(i,c),$("#TRFBtnContainer").empty().append(t))):$("#buttonContainer").empty()}else if(n>=1){var v=!0,y=!0,k=$("#Table tbody tr.selected");n>=1&&(p=$("#Table tbody tr.selected"),p.each(function(){var n=$(this).find("td:eq(1)").text(),t=$(this).find("td:eq(5) button").attr("data-id"),i=$(this).find("td:eq(6) button").attr("data-id"),r=$(this).find("td:eq(7) button").attr("data-id"),u=$(this).find("td:eq(8) button").attr("data-id"),f=$(this).find("td:eq(9) button").attr("data-id");(t!=="0"||i!=="0"||r!=="0"||u!=="0"||f!=="0")&&(v=!1);(t!=="101"||i!=="101"||r!=="101"||u!=="101"||f!=="101")&&(y=!1);ErpSeqArray.includes(n)||ErpSeqArray.push(n)}));deselectRowsAndRemoveFromErpSeqArray();v==!0?($("#TRFBtnContainer").empty().append(t),$("#buttonContainer").empty().append(i)):($("#TRFBtnContainer").empty(),$("#buttonContainer").empty());y==!0&&($("#buttonContainer").empty().append(i),$("#TRFBtnContainer").empty().append(t))}else n===0&&($("#TRFBtnContainer").empty(),$("#buttonContainer").empty(),$("#RowcountDisplay").empty(),startReload())})});