function startReload(){reloadTable();reloadInterval=setInterval(function(){reloadTable()},5e3)}function reloadTable(){$.ajax({url:"/DataVisulization/CheckIsAutoMode",type:"GET",dataType:"json",success:function(n){n==!0?($("#divFilter").hide(),$.ajax({url:"/DataVisulization/ReloadPreProOrder",type:"GET",dataType:"json",success:function(n){totalData=n;const t=$("#Table tbody");t.empty();var n=totalData;n.forEach(function(n){t.append("<tr><td><\/td><td id='PPSeqNo'>"+n.ppSeqNo+"<\/td><td>"+n.itemId+"<\/td><td>"+n.biwNo+"<\/td><td>"+n.vcode+"<\/td><td>"+n.modelCode+"<\/td><td>"+n.fileName+"<\/td><td>"+forDateTime(n.dateIimport)+"<\/td><\/tr>")})},error:function(n){console.error("Error fetching data:",n)}})):($("#divFilter").show(),clearInterval(reloadInterval))},error:function(n){console.error("Error fetching data:",n)}})}function forDateTime(n){var t=new Date(n.split("/").reverse().join("-")),i=`${t.getDate()}`.padStart(2,"0"),r=`${t.getMonth()+1}`.padStart(2,"0"),u=t.getFullYear(),f=t.getHours(),e=t.getMinutes(),o=t.getSeconds();return i+"/"+r+"/"+u+" "+f+":"+e+":"+o}function preback(){setTimeout("preback()",0);window.onunload=function(){null}}var reloadInterval,totalData=[];$(document).ready(function(){function u(){i=n.map(function(n){return{PPSeqNo:parseInt(n[1]),ItemId:n[2],BiwNo:n[3],Vcode:n[4],ModelCode:n[5]}})}function f(t){for(var i=0;i<n.length;i++)if(JSON.stringify(n[i])===JSON.stringify(t))return!0;return!1}function e(){var n=t.rows(".selected").count();$("#RowcountDisplay").text(`Selected ${n}`).append(" of total "+$("#Table tbody tr").length)}startReload();$("#Table").DataTable({dom:"Blfrtip",ordering:!1,buttons:["excel"],columnDefs:[{orderable:!1,className:"select-checkbox",targets:0}],select:{style:"multi",selector:"td:first-child"},paging:!1});$("#select-all-checkbox").on("click",function(){$(this).is(":checked")?t.rows({page:"current"}).select():t.rows().deselect()});var n=[],i=[],t=$("#Table").DataTable(),r=$("#buttonContainer"),o=$("#DivDelete");$("#btnselect").click(function(){var o,s;if($("#fromPpseq").val()==0||$("#fromPpseq").val()==""||$("#toPpseq").val()==0||$("#toPpseq").val()==""){alert("Enter Valid PPSeqNo!");location.reload();return}let h=$("#fromPpseq").val(),c=$("#toPpseq").val();$("#Table tbody tr").each(function(){$(this).removeClass("selected");let n=parseInt($(this).find("#PPSeqNo").text());n>=h&&n<=c&&$(this).addClass("selected").data()});e();t.rows(".selected").count()>0?(o=t.rows(".selected").data(),n=[],o.each(function(t,i){f(i)||n.push(t)}),u(),s=$("<button>",{"class":"btn btn-primary",text:"TRF Production",click:function(){var n=confirm("Are you sure you want to Transfer to Production this orders?");n?$.ajax({type:"POST",url:"/DataVisulization/TRFtoProduction",dataType:"json",contentType:"application/json",data:JSON.stringify(i),success:function(n){n.status==="DataRecived"&&(alert("Production Start"),window.location.reload(),window.location.href="/DataVisulization/Index");n.status==="error"&&(alert("Refresh Page "),location.reload());n.status==="Unauthorized"&&(alert(n.message),location.reload())}}):(alert("Order Transfer to Production canceled."),location.reload())}}),r.empty().append(s)):r.empty()});t.on("select",function(o,s,h){var c,l;h==="row"&&(e(),c=t.rows(".selected").data(),n=[],c.each(function(t,i){f(i)||n.push(t)}),u(),console.log(n),console.log(i));n.length>0&&(l=$("<button>",{"class":"btn btn-primary",text:"TRF Production",click:function(){var n=confirm("Are you sure you want to Transfer to Production this orders?");n?$.ajax({type:"POST",url:"/DataVisulization/TRFtoProduction",dataType:"json",contentType:"application/json",data:JSON.stringify(i),success:function(n){n.status==="DataRecived"&&(alert("Production Start"),window.location.reload(),window.location.href="/DataVisulization/Index");n.status==="error"&&(alert("Refresh Page "),location.reload());n.status==="Unauthorized"&&(alert(n.message),location.reload())}}):(alert("Order Transfer to Production canceled."),location.reload())}}),r.empty().append(l))});t.on("deselect",function(i,o,s){if(s==="row"){e();var h=t.rows(".selected").data();n=[];h.each(function(t,i){f(i)||n.push(t)});console.log(n);u();n.length===0&&r.empty()}});preback()});